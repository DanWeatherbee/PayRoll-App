<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8 /" content="Dans app">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="robots" content="index, follow">
    <meta http-equiv="Cache-control" content="description">
    <meta http-equiv="Set-Cookie" content="name, date">
    <meta name="description" content="Dan Weatherbee's Todo in Backbone">
    <meta name="web_author" content="Dan Weatherbee Web Developer">
    <meta name="keywords" content="web developement,front end developement,front end web developement,danweatherbee,dan weatherbee,portfolio,dan weatherbee developer,danweatherby,dan weatherby,dan weatherbee web developer,dan weatherbee programmer,backbone.js">
    <meta name="author" content="Dan Weatherbee">
    <meta name="copyright" content="Dan Weatherbee">
    <meta name="contact" content="dan@jedi-clan.us">
    <meta name="reply-to" content="dan@jedi-clan.us">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#db5945">
    <meta name="msapplication-square310x310logo" content="favicon.ico">
  <title>Dan Weatherbee's Health Tracker App</title>
  <link rel="stylesheet" href="assets/index.css">
</head>
<body>


  <script src="js/lib/jquery-3.1.1.min.js"></script>
  <script src="js/lib/underscore-min.js"></script>
  <script src="js/lib/backbone-min.js"></script>
  <script src="js/lib/backbone-localstorage.min.js"></script>



<section id="health-tracker">

    <section id="nutritionx">
      <header id="header">
        <h1>Dan Weatherbee</h1>
        <hr>
        <h4>Front End Web Development</h4>
        <h5>Backbone Nutritionx API Health Tracker App Template</h5>
        <input id="search" placeholder="Search a food or Brand?" autofocus>
        <hr>
        <button class="submit">Go</button>
      </header>
      <section id="calorie-count">

      </section>
      <section id="search-result">

      </section>
      <hr>
</section>

<script>
// Mutables
var keyWord;
var searchResults;
var totalHits;
var apiQuery;
// Globals
var KEY;
var APPID;
var API;
var API_STR_PREFIX;
var API_STR_MID;
var API_STR_KEY;
var GetJsonData;
var foodArray = [];
var itemModel;
var App = function (keyWord) {
        KEY = "b9914a3ffda1ac8218e155c05cb52409";
        this.keyWord;
        APPID = "ffa2c4b5";
        API_STR_PREFIX = "https://api.nutritionix.com/v1_1/search/" + keyWord + "%20";
        API_STR_MID = "?fields=item_name%2Citem_id%2Cbrand_name" +
                "%2Cnf_calories%2Cnf_total_fat&appId=";
        API_STR_KEY = "&appKey=";
        API = API_STR_PREFIX +
                keyWord +
                API_STR_MID +
                APPID +
                API_STR_KEY +
                KEY;
          $.getJSON(API, function(data, status) {
                searchResults = data.hits;
                totalHits = data.total_hits;
                status = status;
                var i = 0;
                $('#search-result').html('');
                foodArray = [];
                searchResults.forEach(function (iterator) {
                    // Model
                    itemModel = {
                    title: searchResults[i].fields.item_name,
                    brand: searchResults[i].fields.brand_name,
                    calories: searchResults[i].fields.nf_calories,
                    fat: searchResults[i].fields.nf_total_fat,
                    id: i
                    };

                    $('#search-result').append('<button class="items-bt"><p>Item: ' +
                        itemModel.title + '</p><p>Brand: ' +
                        itemModel.brand + '</p><p>Calories: ' +
                        itemModel.calories + '</p><p>Fat: ' +
                        itemModel.fat + '</p><p>Id: ' +
                        itemModel.id +
                        '</p></button>');
                    foodArray.push(itemModel);
                    i++;
                });
              });
};

var SearchItem = Backbone.Model.extend({
                calories: "im working",
                defaults: {
                     calories: "default 160",
                     done: false
                }
});


var model = new SearchItem();
var model2 = new SearchItem({calories: "20000", done: false}, {calories: "20010", done: false});

var model3 = [{calories: "20000", done: false}, {calories: "20010", done: false}];


 var View = Backbone.View.extend({

                initialize: function () {
                     this.render();
                },


                el: '#health-tracker',
                model: model2,
                events: {
                        "click .submit": "query"
                },




                query: function () {

                     app = new App($('#search').val());


                     var foo = this.model.get('calories')
                     console.log(foo);

                },

                computeCalories: function (totalCal) {

                },

                render: function () {


                }
        });


var SearchItems = Backbone.Collection.extend({
              initialize: function () {
                     console.log("SearchItems is initialized.")

              }
});


var items = new SearchItems({model: model3});
items.add({calories: "new cal", done: false});
items.models[0].attributes.model.forEach(function(i) {
       console.log("hello world");
});


 appView = new View();

</script>

</body>
</html>