<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8 /" content="Dans app">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="robots" content="index, follow">
    <meta http-equiv="Cache-control" content="description">
    <meta http-equiv="Set-Cookie" content="name, date">
    <meta name="description" content="Dan Weatherbee's Payroll in Backbone">
    <meta name="web_author" content="Dan Weatherbee Web Developer">
    <meta name="keywords" content="web developement,front end developement,front end web developement,danweatherbee,dan weatherbee,portfolio,dan weatherbee developer,danweatherby,dan weatherby,dan weatherbee web developer,dan weatherbee programmer,backbone.js">
    <meta name="author" content="Dan Weatherbee">
    <meta name="copyright" content="Dan Weatherbee">
    <meta name="contact" content="dan@jedi-clan.us">
    <meta name="reply-to" content="dan@jedi-clan.us">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#db5945">
    <meta name="msapplication-square310x310logo" content="favicon.ico">
  <title>Dan Weatherbee's payroll App</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.3.0/css/mdb.min.css">
  <link rel="stylesheet" href="assets/index_payroll_version_2.css">

</head>
<body>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script> -->
    <script src="js/lib/jquery-3.1.1.min.js"></script>


    <!-- https://mdbootstrap.com/css/animations/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.3.0/js/mdb.min.js"></script>

<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script> -->

    <script src="js/lib/underscore-min.js"></script>

<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.3.3/backbone-min.js"></script> -->

    <script src="js/lib/backbone-min.js"></script>


<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone-localstorage.js/1.1.16/backbone.localStorage-min.js"></script> -->

    <script src="js/lib/backbone-localstorage.min.js"></script>

<!--  While Bootstrap uses ems or rems for defining most sizes,
pxs are used for grid breakpoints and container widths.
This is because the viewport width is in pixels and does not change with the font size. -->


    <section class="container" id="main"></section>
        <!-- <img id="img-temp" src="template.png"></img> -->
        <!-- Backbone Template===========================> -->

        <script type="text/template" id="app-template">

        <p>Earnings and Hours</p>
        <hr>
        <table>
          <thead>
            <tr>
              <th>Qty</th>
              <th>Rate</th>
            </tr>
          </thead>
          <tbody>

              <tr>
                <td>
                <select class="form-control" id="sel-qty">
                    <option>55</option>
                    <option>56</option>
                    <option>57</option>
                </select>
                  </td>
                <td>
                  <select class="form-control" id="sel-rate">
                    <option>14</option>
                    <option>15</option>
                    <option>16</option>
                  </select>
                </td>
              </tr>
          </tbody>
        </table>

        <button class="btn btn-primary btn-print">Save to PDF</button>
        </script>


        <script type="text/template" id="trans-template">


        <hr>
        <h3 id="total-models"></h3>
        <table>
          <thead>
            <tr>
              <th>Qty</th>
              <th>Rate</th>
              <th>Current</th>
              <th>Vac</th>
              <th>Gross</th>
            </tr>
          </thead>
          <tbody>

              <tr>
                <td id="qty">test</td>
                <td id="rate"><%= "this.gross.toFixed(2)" %></td>
                <td id="cur"><%= "this.cur.toFixed(2)" %></td>
                <td id="vac"><%= "this.vac.toFixed(2)" %></td>
                <td id="gross"><%= "this.gross.toFixed(2)" %></td>
              </tr>
          </tbody>
        </table>
        <button class="btn btn-primary btn-add" data-test= "">Add data</button>

        </script>







    <script>
        // Global Constants
        var TIME = new Date();
        var D = TIME.getDay();
        var M = TIME.getMonth();
        var Y = TIME.getFullYear();

        /*global $ */
        /*jshint unused:false */
        var app = app || {};
        var ENTER_KEY = 13;
        var ESC_KEY = 27;




        Model = Backbone.Model.extend({
            qty: 15

        });


        Collection = Backbone.Collection.extend({
            model: Model,
            localStorage: new Backbone.LocalStorage('payroll'),
            populate: function () {



                for (var i = 0;i < collection.models.length; i++) {

                    $('#qty').prepend('<p>' + collection.models[i].attributes.qty + '</p><hr>');

                    $('#rate').prepend('<p>' + collection.models[i].attributes.rate + '</p><hr>');
                    $('#cur').prepend('<p>' + collection.models[i].attributes.cur + '</p><hr>');

                    $('#vac').prepend('<p>' + collection.models[i].attributes.vac + '</p><hr>');
                    $('#gross').prepend('<p>' + collection.models[i].attributes.gross + '</p><hr>');

                }
                $('#total-models').append("Total Transactions in collection: " + collection.models.length)

            }
        });

        collection = new Collection();


        AppView = Backbone.View.extend({
            el: '.container',
            appTemplate: _.template($('#app-template').html()),
            events: {
                'click [data-test]': 'addData'
            },
            initialize: function () {

                collection.fetch();



            this.listenTo(collection, 'populate', this.addData);

            // Suppresses 'add' events with {reset: true} and prevents the app view
            // from being re-rendered for every model. Only renders when the 'reset'
            // event is triggered at the end of the fetch.
            // app.todos.fetch({reset: true});

            this.render();
            },

            addData: function () {

                var QTY = Number($('#sel-qty option:selected').text());
                var RATE = Number($('#sel-rate option:selected').text());
                var CUR = QTY * RATE;

                var VAC = CUR * .04;

                var GROSS = CUR + VAC;



                var Fred = {
                    qty: QTY,
                    rate: RATE,
                    cur: CUR,
                    vac: VAC,
                    gross: GROSS
                    };



                var fred = new Model(Fred);


                collection.add(fred);

                fred.save();






            },

            // Re-rendering the App just means refreshing the statistics -- the rest
            // of the app doesn't change.
            render: function () {


                this.$el.append(this.appTemplate);



            }

        });


        var app = new AppView();


        PayrollView = Backbone.View.extend({



            el: '.container',
            transTemplate: _.template($('#trans-template').html()),


            initialize: function() {


                collection.fetch();


                this.render();
        },
        render: function () {
            this.$el.append(this.transTemplate);
            collection.populate();
        }

        });

        var pay = new PayrollView();


    </script>
</body>
</html>